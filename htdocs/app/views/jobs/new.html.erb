<img id="background" src="/images/background.jpg" />
<div id="new_job_content_wrapper">
<h1>Start Parameter Estimation</h1>



<% form_for(@job, :html => {:multipart => true}) do |f| %>
  <%= f.error_messages %>
<div class="new_job_thin_column">&nbsp;</div>

<div class="new_job_content_column">
  <div style="display:none">
    <div id="input_data">
      <p>
        <label for="dialog_input_data">Input Data:</label><br />
        <textarea cols="30" rows="15" id="dialog_input_data"></textarea>
      </p>
    </div>
  </div>
  <div id="job_data_header" onclick="toggle_panel(this);" class="panel_header open">Job Data</div>
  <div id="job_data_panel" class="panel_body">
    <div>
      <a href="/tutorial.html"><%= f.label :job_name, nil, :id => "job_name_label" %></a>:<%= f.text_field :job_name %><br/>
      <a href="/tutorial.html"><%= f.label :nodes, nil, :id => "nodes_label" %></a>: <%= f.text_field :nodes, :size => 10 %>&nbsp;
      &nbsp;<a href="/tutorial.html"><%= f.label :pvalue, nil, :id => "pvalue_label" %></a>: <%= f.text_field :pvalue, :size => 10 %><br/>
      <%= f.hidden_field :input_data, :id => "hidden_input_data", :value => "# First time course 
1.2  2.3  3.4
1.1  1.2  1.3
2.2  2.3  2.4
0.1  0.2  0.3
" %>
      <a href="/tutorial.html"><%= f.label :input_file, nil, :id => "input_file_label" %></a>:
      <%= f.file_field :input_file %>
      <br />
      <button type="button" onclick="show_input_modal('input_data', 'Enter Input Data');">Manually Enter Input Data</button>
    </div>
  </div>
<br/><br/>
  <div style="display:none">
    <div id="known_functions">
      <p>
        <label for="dialog_known_functions">Known Functions:</label><br />
        <textarea cols="30" rows="15" id="dialog_known_functions" onChange="$('hidden_known_functions').value = this.value;"></textarea>
      </p>
    </div>
  </div>
  <div id="known_functions_header" onclick="toggle_panel(this);" class="panel_header closed">Known Functions Data</div>
  <div id="known_functions_panel" class="panel_body">
    <div>
      <%= f.hidden_field :known_functions, :id => "hidden_known_functions" %>
      <%= f.label :known_functions_file %>:
      <%= f.file_field :known_functions_file %>
      <br />
      <button type="button" onclick="show_input_modal('known_functions', 'Enter Known Functions');">Manually Enter Known Functions</button>
    </div>
  </div>
  <br/>
  <div id="algorithm_header" onclick="toggle_panel(this);" class="panel_header closed">Parameter estimation algorithm options</div>
  <div id="algorithm_panel" class="panel_body"> 
    <div>
      <%= f.check_box :show_functions %>&nbsp;<%= f.label :show_functions, "Generate Functions" %><br/>
      <%= f.check_box :make_deterministic_model %>&nbsp;<%= f.label :make_deterministic_model %><br/>
      <a href="/tutorial.html"><%= f.label :algorithm, nil, :id => "algorithm_label" %></a>:
      <%= f.select :algorithm, [
        ["default", "default"],
        ["Minsets", "minsets"],
        ["Gfan", "gfan"],
        ["React", "react"],
      ], {}, { :onchange => "if(this.options[this.selectedIndex].value == 'react') Modalbox.show( $('react_param'), {title: 'React Parameters', width: 300});" } %><br />
      <%= f.hidden_field :react_param_data, :id => "hidden_param_data" %>
    </div>
  </div>
  <div style="display:none;">
    <div id="react_param">
      <%= f.label :react_param_data %>:
      <%= f.file_field :react_param_data %>
    </div>
  </div>

  <br/>

  <div id="discretization_header" onclick="toggle_panel(this);" class="panel_header closed">Discretization Options</div>
  <div id="discretization_panel" class="panel_body"> 
    <div>
      <%= f.check_box :show_discretized %>&nbsp;<%= f.label :show_discretized
      %> <br />
      <%= f.label :discretization_threshold %>:
      <%= f.text_field :discretization_threshold, :size => 10 %>
      <br>
      Can we give the user other options to discretize his data?
    </div>
  </div>

</div>


<div class="new_job_empty_column">&nbsp;</div>

<div class="new_job_content_column">
  <div id="wiring_diagram_header" onclick="toggle_panel(this);" class="panel_header open">Wiring Diagram Options</div>
  <div id="wiring_diagram_panel" class="panel_body"> 
    <div>
    <%= f.check_box :show_wiring_diagram %>&nbsp;<%= f.label :show_wiring_diagram, "Generate Wiring Diagram" %><br />
      <%= f.label "Format: " %>
    <%= f.select :wiring_diagram_format, [ 
        ["*.gif", "gif"],
        ["*.jpg", "jpg"],
        ["*.png", "png"],
        ["*.ps", "ps"],
      ] %><br />
    <%= f.check_box :show_probabilities_wiring_diagram %>&nbsp;<%= f.label :show_probabilities_wiring_diagram %>
    </div>
  </div>
  
  <br>

  <div id="simulation_header" onclick="toggle_panel(this);" class="panel_header open">Simulation Options</div>
  <div id="simulation_panel" class="panel_body"> 
  <div>
    <%= f.check_box :show_state_space %>&nbsp;<%= f.label :show_state_space, "Generate State Space" %><br />
    <%= f.label "Format: " %>
	<%= f.select :state_space_format, [ 
			["*.gif", "gif"],
			["*.jpg", "jpg"],
			["*.png", "png"],
			["*.ps", "ps"],
		] %><br />
  <%= f.label :probability_threshold %>:
  <%= f.text_field :probability_threshold, :size => 10 %><br />
	<%= f.check_box :show_probabilities_state_space %>&nbsp;<%= f.label :show_probabilities_state_space %>
	<br/>
	<%= f.label :update_type %>:
	<%= f.select :update_type, [ 
		["synchronous", "synchronous"],
		["sequential", "sequential"],
	] %><br />
	<button type="button" onclick="show_input_modal('update_schedule', 'Enter Update Schedule');">Enter Update Schedule</button>
	<%= f.hidden_field :update_schedule, :id => "hidden_update_schedule" %>
    </div>
  </div>
  <div style="display:none">
	   <div id="update_schedule">
	     <p>
		<label for="dialog_update_schedule">Update Schedule:</label><br>
	     	<textarea id="dialog_update_schedule" cols="30" rows="3"></textarea>
	     </p>
	   </div>
  </div>


</div>
  
<div style="clear: both"></div>
  <p>
    <%= f.submit 'Start Computation' %>
  </p>
<% end %>
</div>
<%= render :partial => "jobs/tooltips" %>
