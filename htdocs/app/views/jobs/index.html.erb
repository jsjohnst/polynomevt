<h1>Listing jobs</h1>

<table cellpadding="3" cellspacing="3" bgcolor="#C3C3C3">
  <tr class="menubar">
	<th>Meta</th>
	<th>Input Data</th>
	<th>Log</th>
	<th>Results</th>
	<th colspan="2">Actions</th>
  </tr>

<% @jobs.each do |job| %>
  <tr bgcolor="<% if job.completed %>#CCFFCC<% elsif job.failed %>#800517<% else %>#FFFFFF<% end %>">
    <td>
		<b>Name:</b> <%=h job.job_name %><br>
		<b>Date:</b> <%=h job.created_at %><br>
		<b>Nodes:</b> <%=h job.nodes %><br>
		<b>Pvalue:</b> <%=h job.pvalue %><br>
		<b>Deterministic:</b> <%=h job.make_deterministic_model %><br>
		<b>Update Type:</b> <%=h job.update_type %><br>
	</td>
    <td><pre><%=h job.input_data %></pre></td>
 	<td><div style="overflow: auto; width: 150px;"><pre><%=h job.log %></pre></div></td>
	<td>
		<% if job.completed %>
			<a href="/<%= job.file_prefix %>.input.txt">Input Data</a><br/>
			<a href="/<%= job.file_prefix %>.discretized_input.txt">Discretized Data</a><br/>
			

			<% if job.show_wiring_diagram %>
        <%= make_lightbox_link(
        "/#{job.file_prefix}.wiring_diagram.#{job.wiring_diagram_format}", 
        "Wiring Diagram", "[job#{job.id.to_s}]") %>
      <br/>
				<a href="/<%= job.file_prefix %>.wiring_diagram.dot">WD Dot File</a><br/>
			<% end %>
			
			<% if job.show_state_space %>
        <%= make_lightbox_link(
        "/#{job.file_prefix}.state_space.#{job.state_space_format}", 
        "State Space", "[job#{job.id.to_s}]") %>
      <br/>
			<% end %>
			
			<% if job.show_functions %>
				<a href="/<%= job.file_prefix %>.functionfile.txt">Show Functions</a><br/>
			<% end %>

			<a href="/<%= job.file_prefix %>.job.zip">Download zip of all files</a><br />
		<% end %>
	</td>
    <td><%= link_to 'Show', job %></td>
    <td><%= link_to 'Destroy', job, :confirm => 'Are you sure?', :method => :delete %></td>
  </tr>
<% end %>
</table>

<br />

<%= link_to 'New job', new_job_path %>
